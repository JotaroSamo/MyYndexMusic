<Page
    x:Class="MyYndexMusic.Pages.PlayListPage.PlayList"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="Transparent"
    Title="PlayList"
    d:DesignHeight="450"
    d:DesignWidth="800">
    <Grid Margin="20">
        <!-- Определение строк -->
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Кнопка "Назад" -->
        <Button
            Content="Назад"
            Click="BackButton_Click"
            Width="758"
            Height="40"
            HorizontalAlignment="Center"
            VerticalAlignment="Top"
            FontSize="16"
            Background="#3F3F3F"
            Foreground="White"
            BorderBrush="#606060"
            BorderThickness="1" />

        <!-- Область для плейлистов -->
        <ScrollViewer Grid.Row="1"  VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <ListView
                Name="PlaylistsItemsControl"
                ItemsSource="{Binding Playlists}"
                Background="Transparent"
                BorderBrush="Transparent"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch"
                Padding="10">

                <!-- Позиционирование элементов -->
                <ListView.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel
                            HorizontalAlignment="Stretch"
                            ItemHeight="240"
                            ItemWidth="250"
                            MaxWidth="{Binding ActualWidth, ElementName=PlaylistsItemsControl}"
                            VerticalAlignment="Stretch" />
                        <!--  Привязка ширины к фактической ширине ListView  -->
                    </ItemsPanelTemplate>
                </ListView.ItemsPanel>

                <!-- Шаблон карточки -->
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <Border
                            Background="#2D2D2D"
                            CornerRadius="10"
                            Margin="10"
                            Width="200"
                            Height="250"
                            BorderBrush="#3F3F3F"
                            BorderThickness="1">
                            <StackPanel>
                                <!-- Изображение -->
                                <Image
                                    Source="{Binding Image}"
                                    Width="100"
                                    Height="100"
                                    HorizontalAlignment="Center"
                                    Stretch="UniformToFill"
                                    Margin="0,10,0,10"
                                    ClipToBounds="True" />

                                <!-- Название -->
                                <TextBlock
                                    Text="{Binding Title}"
                                    FontSize="14"
                                    FontWeight="Bold"
                                    Foreground="White"
                                    TextAlignment="Center"
                                    Margin="0,0,0,10"
                                    TextWrapping="Wrap" />

                                <!-- Кнопка -->
                                <Button
                                    Content="▶"
                                    Tag="{Binding Uid}"
                                    Width="50"
                                    Height="30"
                                    HorizontalAlignment="Center"
                                    Background="#414141"
                                    Foreground="White"
                                    BorderBrush="#606060"
                                    BorderThickness="1"
                                    Click="ButtonBase_OnClick" />

                            </StackPanel>
                            <Border.ContextMenu>
                                <ContextMenu Background="#2D2D2D" BorderBrush="#3F3F3F" Padding="5">
                                    <ContextMenu.Resources>
                                        <!-- Стиль для каждого элемента -->
                                        <Style TargetType="MenuItem">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="MenuItem">
                                                        <Border
                                Background="#2D2D2D"
                                BorderBrush="#3F3F3F"
                                BorderThickness="1"
                                CornerRadius="8"
                                Padding="5"
                                Margin="2">
                                                            <Grid Height="50">
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="40" />
                                                                    <!-- Для изображения -->
                                                                    <ColumnDefinition Width="*" />
                                                                    <!-- Для текста -->
                                                                    <ColumnDefinition Width="50" />
                                                                    <!-- Для кнопки -->
                                                                </Grid.ColumnDefinitions>

                                                                <!-- Изображение -->
                                                                <Image
                                        Source="{Binding Image}"
                                        Width="30"
                                        Height="30"
                                        VerticalAlignment="Center"
                                        HorizontalAlignment="Center"
                                        Grid.Column="0" />

                                                                <!-- Текст -->
                                                                <TextBlock
                                        Text="{Binding Title}"
                                        FontSize="14"
                                        Foreground="White"
                                        VerticalAlignment="Center"
                                        TextWrapping="NoWrap"
                                        Margin="10,0,10,0"
                                        Grid.Column="1" />

                                                                <!-- Кнопка -->
                                                                <Button
                                        Content="▶"
                                        Width="30"
                                        Height="30"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Background="#414141"
                                        Foreground="White"
                                        BorderBrush="#606060"
                                        BorderThickness="1"
                                        Tag="{Binding}"
                                        Click="TrackButton_OnClick"
                                        Grid.Column="2" />
                                                            </Grid>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </ContextMenu.Resources>

                                    <!-- Привязка элементов -->
                                    <ContextMenu.ItemsSource>
                                        <Binding Path="Tracks" />
                                    </ContextMenu.ItemsSource>
                                </ContextMenu>
                            </Border.ContextMenu>

                        </Border>
                    </DataTemplate>

                </ListView.ItemTemplate>

            </ListView>
        </ScrollViewer>
    </Grid>
</Page>


